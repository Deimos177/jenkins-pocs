pipeline {
    agent any
    stages {
        stage('Clone repo') {
            steps {
                checkout scmGit(
                  branches: [[name: "*/${params.repoBranch}"]],
                  extensions: [],
                  userRemoteConfigs: [[credentialsId: 'git-credentials',
                  url: "${repo}"]])
            }
        }
        stage('Junit tests coverage'){
          steps{
            junit healthScaleFactor: 0.1,
            allowEmptyResults: true,
            stdioRetention: '',
            testResults: '**/tests-report/*.xml'
          }
        }
        stage('Building image'){
          steps{
            echo 'Starting to build the docker image'
            image = readMavenPom(file: 'pom.xml').getArtifactId()
            echo "image to build: ${image}:${env.BUILD_ID}"
          }
        }
    }
}
